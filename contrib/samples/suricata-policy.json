{
  "policy" : {
    "description" : "rotate 10gb or 119000000 or 7d primaries then delete after 90d",
    "error_notification" : null,
    "default_state" : "hot",
    "states" : [
      {
        "name" : "hot",
        "actions" : [
          {
            "retry" : {
              "count" : 3,
              "backoff" : "exponential",
              "delay" : "1m"
            },
            "rollover" : {
              "min_doc_count" : 119000000,
              "min_index_age" : "7d",
              "min_primary_shard_size" : "10gb",
              "copy_alias" : false
            }
          }
        ],
        "transitions" : [
          {
            "state_name" : "warm"
          }
        ]
      },
      {
        "name" : "warm",
        "actions" : [
          {
            "retry" : {
              "count" : 3,
              "backoff" : "exponential",
              "delay" : "1m"
            },
            "read_only" : { }
          }
        ],
        "transitions" : [
          {
            "state_name" : "delete",
            "conditions" : {
              "min_rollover_age" : "90d"
            }
          }
        ]
      },
      {
        "name" : "delete",
        "actions" : [
          {
            "retry" : {
              "count" : 3,
              "backoff" : "exponential",
              "delay" : "1m"
            },
            "delete" : { }
          }
        ],
        "transitions" : [ ]
      }
    ],
    "ism_template" : [
      {
        "index_patterns" : [
          "suricata-*"
        ],
        "priority" : 500
      }
    ]
  }
}
